@using E_Commerce.ViewModels
@model HomeViewModel

@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/_Shop.cshtml";
}

@section shopCategories
{
    <h4>Categories</h4>
    <ul class="list-unstyled fruite-categorie">
        @foreach (var category in Model.Categories)
        {
            <li>
                <div class="d-flex justify-content-between fruite-name">
                    <a asp-action="Index"
                       asp-route-categoryId="@category.Id"
                       asp-route-search="@ViewBag.Search"
                       asp-route-page="1"
                       class="@(ViewBag.CategoryId == category.Id ? "fw-bold text-warning" : "")">
                        <i class="fas fa-apple-alt me-2"></i>@category.Name
                    </a>
                </div>
            </li>
        }
    </ul>
}



@section shopContent
{
    <div class="row g-4">
        @foreach (var product in Model.Products)
        {
            <div class="col-sm-6 col-md-4 col-lg-3">
                <a asp-controller="Product"
                   asp-action="Details"
                   asp-route-id="@product.Id"
                   class="text-decoration-none text-dark d-block h-100">

                    <div class="product-card h-100 position-relative border rounded shadow-sm overflow-hidden">

                        <!-- Product Image -->
                        <div class="product-image">
                            <img src="/images/@product.DefualtImageUrl" class="w-100" />
                        </div>

                        <!-- Category Badge -->
                        <span class="badge bg-secondary position-absolute"
                              style="top:10px; left:10px;">
                            @product.Category?.Name
                        </span>

                        <!-- Product Info -->
                        <div class="product-content p-3">
                            <h5 class="mb-1">@product.Name</h5>
                            <p class="text-muted small mb-2">@product.BriefDescription</p>

                            @if (product.Variants != null && product.Variants.Any())
                            {
                                <div class="product-price fw-bold">
                                    @product.Variants.Min(v => v.Price) EGP
                                </div>
                            }
                        </div>

                    </div>
                </a>
            </div>
        }
    </div>

    <!-- ===== Pagination ===== -->
    <div class="row mt-4">
        <div class="col-12">
            <nav aria-label="Products pagination">
                <ul class="pagination justify-content-center">

                    <li class="page-item @(ViewBag.CurrentPage == 1 ? "disabled" : "")">
                        <a class="page-link"
                           asp-action="Index"
                           asp-route-page="@(ViewBag.CurrentPage - 1)"
                           asp-route-search="@ViewBag.Search">
                            ‹
                        </a>
                    </li>

                    @for (int i = 1; i <= ViewBag.TotalPages; i++)
                    {
                        <li class="page-item @(ViewBag.CurrentPage == i ? "active" : "")">
                            <a class="page-link"
                               asp-action="Index"
                               asp-route-page="@i"
                               asp-route-search="@ViewBag.Search">
                                @i
                            </a>
                        </li>
                    }

                    <li class="page-item @(ViewBag.CurrentPage == ViewBag.TotalPages ? "disabled" : "")">
                        <a class="page-link"
                           asp-action="Index"
                           asp-route-page="@(ViewBag.CurrentPage + 1)"
                           asp-route-search="@ViewBag.Search">
                            ›
                        </a>
                    </li>

                </ul>
            </nav>
        </div>
    </div>

    
}
